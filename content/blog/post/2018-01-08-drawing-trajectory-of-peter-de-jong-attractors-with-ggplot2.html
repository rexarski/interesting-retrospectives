---
title: "Drawing Trajectory of Peter de Jong Attractors with ggplot2"
author: "Qiu Rui"
date: '2018-01-08'
tags:
    - maths
slug: drawing-trajectory-of-peter-de-jong-attractors-with-ggplot2
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>The design was inspired by a blog on <a href="https://fronkonstin.com/2017/11/07/drawing-10-million-points-with-ggplot-clifford-attractors/">Fronkonstin: Experiments in R</a>. I modified the code a little bit, so that the output is generated by <a href="http://paulbourke.net/fractals/peterdejong/">Peter de Jong Attractors</a> instead of <a href="http://paulbourke.net/fractals/clifford/">Clifford Attractors</a>.</p>
<p>The definitive expressions of Peter de Jong Attractors are shown below:</p>
<div>
<span class="math display">\[
\begin{split}
x_{n+1}&amp;=\sin(a\cdot y_n)-\cos(b\cdot x_n)\\
y_{n+1}&amp;=\sin(c\cdot x_n)-\cos(d\cdot y_n)
\end{split}
\]</span>
</div>
<p>Codes:</p>
<pre class="r"><code>library(Rcpp)
library(ggplot2)
library(dplyr)

opt = theme(legend.position  = &quot;none&quot;,
            panel.background = element_rect(fill=&quot;white&quot;),
            axis.ticks       = element_blank(),
            panel.grid       = element_blank(),
            axis.title       = element_blank(),
            axis.text        = element_blank())

cppFunction(&#39;DataFrame createTrajectory(int n, double x0, double y0,
            double a, double b, double c, double d) {
            // create the columns
            NumericVector x(n);
            NumericVector y(n);
            x[0]=x0;
            y[0]=y0;
            for(int i = 1; i &lt; n; ++i) {
            x[i] = sin(a*y[i-1])-cos(b*x[i-1]);
            y[i] = sin(c*x[i-1])-cos(d*y[i-1]);
            }
            // return a new data frame
            return DataFrame::create(_[&quot;x&quot;]= x, _[&quot;y&quot;]= y);
            }
            &#39;)

a = 0.970
b = -1.899
c = 1.381
d = -1.506

df=createTrajectory(10000000, 0, 0, a, b, c, d)

png(&quot;dejong.png&quot;, units=&quot;px&quot;, width=1600, height=1600, res=300)
ggplot(df, aes(x, y)) + geom_point(color=&quot;black&quot;, shape=46, alpha=.01) + opt
dev.off()</code></pre>
<div class="figure">
<img src="/image/dejong.png" alt="" />
<p class="caption">de Jong attractors</p>
</div>
<p>The output looks really pretty good, like a basket. You can visit this <a href="http://paulbourke.net/fractals/peterdejong/">link</a> for more examples and detailed parameters.</p>
